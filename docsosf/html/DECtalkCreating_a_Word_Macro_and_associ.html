<HTML>
<HEAD>
<TITLE>Creating a Word Macro and associating it with a file or template</TITLE>
</HEAD><BODY BGCOLOR="#ffffe0">
<A HREF= "DECtalkDECtalk.html"><IMG SRC="contents.gif" ALT="contents.gif" BORDER = 0></A><A HREF= "DECtalkindex.html"><IMG SRC="index.gif" ALT="index.gif" BORDER = 0></A><A HREF= "DECtalkRunning_DECtalk_Software_from_Ot.html"><IMG SRC="prev1.gif" ALT="prev1.gif" BORDER = 0></A><A HREF= "DECtalkAssociating_a_macro_with_a_toolb.html"><IMG SRC="next1.gif" ALT="next1.gif" BORDER = 0></A>
<P>
<A NAME="off_525431"></A><A NAME="589670fe"></A><A NAME="off_525431"></A><A NAME="589670fe"></A><A NAME="off_525431"></A><A NAME="589670fe"></A><A NAME="off_525431"></A><A NAME="589670fe"></A><A NAME="off_525431"></A><A NAME="589670fe"></A><A NAME="off_525431"></A><A NAME="589670fe"></A><FONT FACE="Arial" SIZE="4"><B>Creating a Word Macro and associating it with a file or template
<P>
</B></FONT><FONT FACE="HELVETICA" SIZE="4">  Click </FONT><FONT FACE="HELVETICA" COLOR="#008000" SIZE="4"><A HREF="DECtalkCreating_a_Word_Macro__illustrat.html">here</A></FONT><FONT FACE="HELVETICA" SIZE="4"> to see a numbered graphic illustrating the following procedure.
<P>
The first step in running DECtalk Software from a Microsoft Word document is
creating the Word macro that links Word and DECtalk through the Dynamic Data
Exchange (DDE) server. You only have to create this macro once and associate it
with a button, hot key, or menu command. If you make the macro part of a
permanent .dot (template) file, DECtalk Software will always be available when you edit
a document associated with that template.
<P>
To create a Word macro:
<P>
</FONT><TABLE><TR VALIGN=TOP><TD><FONT FACE="HELVETICA" COLOR="#000000" SIZE="3"><B>Task/Location
<BR></B></FONT></TD><TD>
<BR></TD><TD><FONT FACE="HELVETICA" COLOR="#000000" SIZE="3"><B>Action
<BR></B></FONT></TD><TD><FONT FACE="HELVETICA" COLOR="#000000" SIZE="3"><B>Result
<BR></B></FONT></TD></TR><TR VALIGN=TOP><TD><FONT FACE="HELVETICA" SIZE="3">Word dialog
<BR></FONT></TD><TD><FONT FACE="HELVETICA" SIZE="3"><B>Step 1
<BR></B></FONT></TD><TD><FONT FACE="HELVETICA" SIZE="3">Select  Macro from the Tools Menu.  (1)
<BR>
<BR></FONT></TD><TD><FONT FACE="HELVETICA" SIZE="3">The Macro dialog box is displayed. </FONT><FONT FACE="Courier" SIZE="3">(2)<IMG SRC="DECtalk00090006.gif" ALT="DECtalk00090006.gif" BORDER=0 WIDTH=16 HEIGHT=17>
<BR></FONT></TD></TR><TR VALIGN=TOP><TD><FONT FACE="HELVETICA" SIZE="3">Macro dialog box </FONT><FONT FACE="Courier" SIZE="3">(2)
<BR></FONT></TD><TD><FONT FACE="HELVETICA" SIZE="3"><B>Step 2
<BR></B></FONT></TD><TD><FONT FACE="HELVETICA" SIZE="3">Enter the name of the macro you are going to create. </FONT><FONT FACE="Courier" SIZE="3">(3)
<BR>
<BR></FONT></TD><TD>
<BR></TD></TR><TR VALIGN=TOP><TD><FONT FACE="HELVETICA" SIZE="3">Macro dialog box </FONT><FONT FACE="Courier" SIZE="3">(2)
<BR>
<BR></FONT></TD><TD><FONT FACE="HELVETICA" SIZE="3"><B>Step 3
<BR></B></FONT></TD><TD><FONT FACE="HELVETICA" SIZE="3">Click the Create button. </FONT><FONT FACE="Courier" SIZE="3">(4)
<BR></FONT></TD><TD><FONT FACE="HELVETICA" SIZE="3">The Macro creation window is displayed.</FONT><FONT FACE="Courier" SIZE="3">(5)
<BR></FONT></TD></TR></TABLE><TABLE><TR VALIGN=TOP><TD><FONT FACE="HELVETICA" SIZE="3">Macro creation window </FONT><FONT FACE="Courier" SIZE="3">(5)
<BR></FONT></TD><TD><FONT FACE="HELVETICA" SIZE="3"><B>Step 4
<BR></B></FONT></TD><TD><FONT FACE="HELVETICA" SIZE="3">Insert the following macro: (Note: you can open the <I>word.txt </I> file located in the \DECTALK\ directory, copy it, and paste it into the Word
macro.)
<BR></FONT><FONT FACE="Courier New" SIZE="3">Sub MAIN
<BR>If AppIsRunning(&quot;TTSsrv&quot;) = 0 Then
<BR>      Shell &quot;TTSSRV.EXE&quot;, 0
<BR>      rightNow = Now()
<BR>      diffTime = 0
<BR>      Print &quot;Starting DECtalk Server&quot;
<BR>      WaitCursor 1
<BR>      While diffTime &lt; 0.00003
<BR>          diffTime = Now() - rightNow
<BR>      Wend
<BR>      WaitCursor 0
<BR>      Print &quot; &quot;
<BR>   If AppIsRunning(&quot;TTSsrv&quot;) = 0 Then
<BR>   MsgBox(&quot;Cannot find TTSSRV.EXE in the path&quot;, &quot;Speak&quot;, 0)
<BR>   Goto FINIS
<BR>   End If
<BR>End If
<BR>   channel = DDEInitiate(&quot;TTSserver&quot;, &quot;Speak&quot;)
<BR>   If channel = 0 Then
<BR>   MsgBox(&quot;Unable to connect to TTSSRV.EXE&quot;, &quot;Speak&quot;, 0)
<BR>   Goto FINIS
<BR>   Else
<BR>      DDEPoke channel, &quot;Speak&quot;, Selection$()
<BR>      DDETerminate channel
<BR>FINIS:
<BR>End Sub
<BR>
<BR></FONT></TD></TR></TABLE><TABLE><TR VALIGN=TOP><TD><FONT FACE="HELVETICA" SIZE="3">File pull-down menu. 
<BR></FONT></TD><TD><FONT FACE="HELVETICA" SIZE="3"><B>Step 5
<BR></B></FONT></TD><TD><FONT FACE="HELVETICA" SIZE="3">On the File menu, click Close  (6). Click Yes  (7) when you are asked if you
want to keep changes to the macro.
<BR></FONT></TD><TD><FONT FACE="HELVETICA" SIZE="3">The macro is created.
<BR>
<BR><HR></FONT></TD></TR></TABLE><FONT FACE="HELVETICA" SIZE="4">  Related topics 
<P>
</FONT></BODY>
</HTML>